apiVersion: v1
kind: ConfigMap
metadata:
  name: litmus-grafana-provisioner
  namespace: monitoring
data:
  default.yaml: |-
    {
        "apiVersion": 1,
        "providers": [
            {
                "name": "Prometheus",
                "orgId": 1,
                "folder": "Services",
                "type": "file",
                "disableDeletion": false,
                "editable": true,
                "options": {
                    "path": "/var/lib/grafana/dashboards",
                    "foldersFromFilesStructure": true
                }
            }
        ]
    }
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: litmus-grafana-dashboards
  namespace: monitoring
  labels:
    grafana_dashboard: "1"
data:
  node_pod_metrics_dashboard.json: |-
    {"annotations":{"list":[{"$$hashKey":"object:137","builtIn":1,"datasource":"-- Grafana --","enable":true,"hide":true,"iconColor":"rgba(0, 211, 255, 1)","name":"Annotations & Alerts","type":"dashboard"},{"datasource":"DS_PROMETHEUS","enable":true,"expr":"litmuschaos_awaited_experiments{chaosresult_name=\"catalogue-pod-cpu-hog-pod-cpu-hog\", chaosresult_namespace=\"litmus\"}","hide":false,"iconColor":"rgba(255, 96, 96, 1)","name":"catalogue-pod-cpu-hog","showIn":0,"step":"1s","tagKeys":"litmus, chaos","textFormat":"pod-cpu-hog","titleFormat":"catalogue-chaos"},{"datasource":"DS_PROMETHEUS","enable":true,"expr":"litmuschaos_awaited_experiments{chaosresult_name=\"orders-pod-memory-hog-pod-memory-hog\", chaosresult_namespace=\"litmus\"}","hide":false,"iconColor":"rgba(255, 96, 96, 1)","name":"orders-pod-memory-hog","showIn":0,"step":"1s","tagKeys":"litmus, chaos","textFormat":"pod-memory-hog","titleFormat":"orders-chaos"},{"datasource":"DS_PROMETHEUS","enable":true,"expr":"litmuschaos_awaited_experiments{chaosresult_name=\"orders-node-memory-hog-node-memory-hog\",chaosresult_namespace=\"litmus\"}","hide":false,"iconColor":"rgba(255, 96, 96, 1)","name":"orders-node-memory-hog","showIn":0,"step":"1s","tagKeys":"litmus, chaos","textFormat":"node-memory-hog","titleFormat":"orders-chaos","useValueForTime":false},{"datasource":"DS_PROMETHEUS","enable":true,"expr":"litmuschaos_awaited_experiments{chaosresult_name=\"catalogue-node-cpu-hog-node-cpu-hog\",chaosresult_namespace=\"litmus\"}","hide":false,"iconColor":"rgba(255, 96, 96, 1)","name":"catalogue-node-cpu-hog","showIn":0,"step":"1s","tagKeys":"litmus, chaos","textFormat":"node-cpu-hog","titleFormat":"catalogue-chaos"}]},"editable":true,"gnetId":null,"graphTooltip":0,"id":3,"iteration":1615817690444,"links":[],"panels":[{"collapsed":false,"datasource":"DS_PROMETHEUS","gridPos":{"h":1,"w":24,"x":0,"y":0},"id":47,"panels":[],"title":"Litmus Chaos Chaos durations interleaved with Node Exporter & Kube-State Metrics","type":"row"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$datasource","fieldConfig":{"defaults":{"custom":{},"links":[]},"overrides":[]},"fill":0,"fillGradient":0,"gridPos":{"h":16,"w":12,"x":0,"y":1},"hiddenSeries":false,"id":64,"interval":"","legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"hideZero":true,"max":false,"min":false,"rightSide":false,"show":true,"sort":"current","sortDesc":true,"total":false,"values":true},"lines":true,"linewidth":1,"nullPointMode":"connected","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.4.3","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"instance:node_cpu_utilisation:rate1m","interval":"","legendFormat":"\"{{instance}}\"","refId":"B"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Chaos - Node - CPU Utilization","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"$$hashKey":"object:92","format":"percentunit","label":"cores","logBase":1,"max":null,"min":null,"show":true},{"$$hashKey":"object:93","format":"short","label":"CHAOS","logBase":2,"max":"1","min":"0","show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$datasource","fieldConfig":{"defaults":{"custom":{},"links":[]},"overrides":[]},"fill":0,"fillGradient":0,"gridPos":{"h":16,"w":12,"x":12,"y":1},"hiddenSeries":false,"id":65,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"hideZero":true,"max":false,"min":false,"rightSide":false,"show":true,"sort":"current","sortDesc":true,"total":false,"values":true},"lines":true,"linewidth":1,"nullPointMode":"null as zero","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.4.3","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"instance:node_memory_utilisation:ratio","interval":"","legendFormat":"\"{{instance}}\"","refId":"B"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Chaos - Node - Memory Utilization","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"$$hashKey":"object:251","format":"percentunit","label":"Memory","logBase":1,"max":null,"min":null,"show":true},{"$$hashKey":"object:252","format":"short","label":"CHAOS","logBase":2,"max":"1","min":"0","show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$datasource","fieldConfig":{"defaults":{"custom":{},"links":[]},"overrides":[]},"fill":0,"fillGradient":0,"gridPos":{"h":13,"w":12,"x":0,"y":17},"hiddenSeries":false,"id":62,"interval":"","legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"hideZero":true,"max":false,"min":false,"rightSide":false,"show":true,"sort":"current","sortDesc":true,"total":false,"values":true},"lines":true,"linewidth":1,"nullPointMode":"connected","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.4.3","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum(rate(container_cpu_usage_seconds_total{container!=\"POD\",pod!=\"\"}[5m])) by (pod)","interval":"","legendFormat":"\"{{pod}}\"","refId":"B"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Chaos - Pod - CPU Usage","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"$$hashKey":"object:535","format":"short","label":"cores","logBase":1,"max":null,"min":null,"show":true},{"$$hashKey":"object:536","format":"short","label":"CHAOS","logBase":2,"max":"1","min":"0","show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$datasource","fieldConfig":{"defaults":{"custom":{},"links":[]},"overrides":[]},"fill":0,"fillGradient":0,"gridPos":{"h":13,"w":12,"x":12,"y":17},"hiddenSeries":false,"id":63,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"hideZero":true,"max":false,"min":false,"rightSide":false,"show":true,"sort":"current","sortDesc":true,"total":false,"values":true},"lines":true,"linewidth":1,"nullPointMode":"connected","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.4.3","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum(container_memory_usage_bytes{container!=\"POD\",container!=\"\"}) by (pod)","interval":"","legendFormat":"\"{{pod}}\"","refId":"B"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Chaos - Pod - Memory Usage","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"$$hashKey":"object:665","format":"bytes","label":"Memory","logBase":1,"max":null,"min":null,"show":true},{"$$hashKey":"object:666","format":"short","label":"CHAOS","logBase":2,"max":"1","min":"0","show":false}],"yaxis":{"align":false,"alignLevel":null}}],"refresh":"5s","schemaVersion":27,"style":"dark","tags":[],"templating":{"list":[{"current":{"selected":false,"text":"DS_PROMETHEUS","value":"DS_PROMETHEUS"},"description":null,"error":null,"hide":0,"includeAll":false,"label":"","multi":false,"name":"datasource","options":[],"query":"prometheus","queryValue":"","refresh":1,"regex":"","skipUrlSync":false,"type":"datasource"},{"allValue":null,"current":{"isNone":true,"selected":false,"text":"None","value":""},"datasource":"$datasource","definition":"label_values(kube_pod_info, cluster)","description":null,"error":null,"hide":2,"includeAll":false,"label":null,"multi":false,"name":"cluster","options":[],"query":{"query":"label_values(kube_pod_info, cluster)","refId":"DS_PROMETHEUS-cluster-Variable-Query"},"refresh":1,"regex":"","skipUrlSync":false,"sort":1,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false}]},"time":{"from":"now-30m","to":"now"},"timepicker":{"refresh_intervals":["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"]},"timezone":"","title":"Node and Pod Chaos Metrics","uid":"nodepodmetrics","version":1}
 
  pxc_galera_node_dashboard.json: |-
    {"annotations":{"list":[{"$$hashKey":"object:627","datasource":"DS_PROMETHEUS","enable":true,"expr":"litmuschaos_awaited_experiments","hide":true,"iconColor":"rgba(255, 96, 96, 1)","limit":100,"name":"LitmusChaos","showIn":0,"step":"1s","tagKeys":"pod-network-chaos","tags":[],"textFormat":"pod-network-chaos","titleFormat":"chaos","type":"tags","useValueForTime":false},{"$$hashKey":"object:448","builtIn":1,"datasource":"-- Grafana --","enable":true,"hide":false,"iconColor":"#e0752d","limit":100,"matchAny":true,"name":"PMM Annotations","showIn":0,"tags":["pmm_annotation","$node_name","$service_name"],"type":"tags"},{"$$hashKey":"object:449","builtIn":1,"datasource":"-- Grafana --","enable":true,"hide":true,"iconColor":"#6ed0e0","limit":100,"name":"Annotations & Alerts","showIn":0,"tags":[],"type":"dashboard"}]},"editable":true,"gnetId":null,"graphTooltip":1,"id":4,"iteration":1615978059641,"links":[{"icon":"doc","includeVars":true,"keepTime":true,"tags":["Home"],"targetBlank":false,"title":"Home","type":"link","url":"\/graph\/d\/pmm-home\/home-dashboard"},{"icon":"dashboard","includeVars":true,"keepTime":true,"tags":["Query Analytics"],"targetBlank":false,"title":"Query Analytics","type":"link","url":"\/graph\/d\/pmm-qan\/pmm-query-analytics"},{"icon":"bolt","includeVars":true,"keepTime":true,"tags":["Compare"],"targetBlank":false,"title":"Compare","type":"link","url":"\/graph\/d\/pxc-nodes-compare\/pxc-galera-nodes-compare"},{"asDropdown":true,"includeVars":true,"keepTime":true,"tags":["MySQL"],"targetBlank":false,"title":"MySQL","type":"dashboards"},{"asDropdown":true,"includeVars":true,"keepTime":true,"tags":["MySQL_HA"],"targetBlank":false,"title":"HA","type":"dashboards"},{"asDropdown":true,"includeVars":false,"keepTime":true,"tags":["Services"],"targetBlank":false,"title":"Services","type":"dashboards"},{"asDropdown":true,"includeVars":false,"keepTime":true,"tags":["PMM"],"targetBlank":false,"title":"PMM","type":"dashboards"}],"panels":[{"breadcrumbItemsMaxAmount":6,"datasource":"DS_PROMETHEUS","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"gridPos":{"h":2,"w":24,"x":0,"y":0},"hideTextInRootDashboard":false,"id":999,"isRootDashboard":false,"links":[],"targets":[{"expr":"","format":"time_series","intervalFactor":1,"refId":"A"}],"timeFrom":null,"timeShift":null,"title":" ","transparent":true,"type":"digiapulssi-breadcrumb-panel"},{"cacheTimeout":null,"colorBackground":false,"colorValue":true,"colors":["#FA6400","rgba(237, 129, 40, 0.89)","rgba(255, 255, 255, 0.97)"],"datasource":"DS_PROMETHEUS","decimals":0,"editable":true,"error":false,"fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"format":"none","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":2,"w":4,"x":0,"y":2},"height":"125px","hideTimeOverride":true,"id":50,"interval":"$interval","links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"80%","rangeMaps":[{"from":"null","text":"N\/A","to":"null"}],"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":true},"tableColumn":"","targets":[{"calculatedInterval":"10m","datasourceErrors":{},"errors":{},"expr":"mysql_global_status_wsrep_ready{service_name=~\"$service_name\"}","interval":"5m","intervalFactor":1,"legendFormat":"","metric":"","refId":"A","step":300}],"thresholds":"0.5,1","timeFrom":"1m","timeShift":"1m","title":"Ready to Accept Queries","type":"singlestat","valueFontSize":"50%","valueMaps":[{"op":"=","text":"ON","value":"1"},{"op":"=","text":"OFF","value":"0"}],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":true,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"datasource":"DS_PROMETHEUS","decimals":0,"editable":true,"error":false,"fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"format":"none","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":2,"w":4,"x":4,"y":2},"height":"125px","hideTimeOverride":true,"id":49,"interval":"$interval","links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"80%","rangeMaps":[{"from":"null","text":"N\/A","to":"null"}],"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":true},"tableColumn":"","targets":[{"calculatedInterval":"10m","datasourceErrors":{},"errors":{},"expr":"mysql_global_status_wsrep_local_state{service_name=~\"$service_name\"}","format":"time_series","interval":"5m","intervalFactor":1,"legendFormat":"","metric":"","refId":"A","step":300}],"thresholds":"2,4","timeFrom":"1m","timeShift":"1m","title":"Local State","type":"singlestat","valueFontSize":"50%","valueMaps":[{"op":"=","text":"Joining","value":"1"},{"op":"=","text":"Donor\/Desynced","value":"2"},{"op":"=","text":"Joined","value":"3"},{"op":"=","text":"Synced","value":"4"}],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":true,"colors":["#FA6400","rgba(237, 129, 40, 0.89)","rgba(255, 255, 255, 0.9)"],"datasource":"DS_PROMETHEUS","decimals":0,"editable":true,"error":false,"fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"format":"none","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":2,"w":4,"x":8,"y":2},"height":"125px","hideTimeOverride":true,"id":53,"interval":"$interval","links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"80%","rangeMaps":[{"from":"null","text":"N\/A","to":"null"}],"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":true},"tableColumn":"","targets":[{"calculatedInterval":"10m","datasourceErrors":{},"errors":{},"expr":"mysql_global_variables_wsrep_desync{service_name=~\"$service_name\"}","format":"time_series","interval":"5m","intervalFactor":1,"legendFormat":"","metric":"","refId":"A","step":300}],"thresholds":"0.5,1","timeFrom":"1m","timeShift":"1m","title":"Desync Mode","type":"singlestat","valueFontSize":"50%","valueMaps":[{"op":"=","text":"ON","value":"1"},{"op":"=","text":"OFF","value":"0"}],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":true,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"datasource":"DS_PROMETHEUS","decimals":0,"editable":true,"error":false,"fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"format":"none","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":2,"w":4,"x":12,"y":2},"height":"125px","hideTimeOverride":true,"id":51,"interval":"$interval","links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"80%","rangeMaps":[{"from":"null","text":"N\/A","to":"null"}],"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":true},"tableColumn":"","targets":[{"calculatedInterval":"10m","datasourceErrors":{},"errors":{},"expr":"mysql_global_status_wsrep_cluster_status{service_name=~\"$service_name\"}","format":"time_series","interval":"5m","intervalFactor":1,"legendFormat":"","metric":"","refId":"A","step":300}],"thresholds":"0.5,1","timeFrom":"1m","timeShift":"1m","title":"Cluster Status","type":"singlestat","valueFontSize":"50%","valueMaps":[{"op":"=","text":"Primary","value":"1"},{"op":"=","text":"Non-primary","value":"0"}],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":false,"colors":["rgba(50, 172, 45, 0.97)","rgba(237, 129, 40, 0.89)","rgba(245, 54, 54, 0.9)"],"datasource":"DS_PROMETHEUS","decimals":0,"editable":true,"error":false,"fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"format":"bytes","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":2,"w":4,"x":16,"y":2},"height":"125px","id":48,"interval":"$interval","links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"80%","rangeMaps":[{"from":"null","text":"N\/A","to":"null"}],"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":true},"tableColumn":"","targets":[{"calculatedInterval":"10m","datasourceErrors":{},"errors":{},"expr":"avg by (service_name) (mysql_galera_gcache_size_bytes{service_name=~\"$service_name\"})","format":"time_series","interval":"5m","intervalFactor":1,"legendFormat":"","metric":"","refId":"A","step":300}],"thresholds":"90,95","title":"gcache Size","type":"singlestat","valueFontSize":"50%","valueMaps":[],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":true,"colors":["#FA6400","#508642","rgb(255, 255, 255)"],"datasource":"DS_PROMETHEUS","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"format":"short","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":2,"w":4,"x":20,"y":2},"id":55,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"maxPerRow":6,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N\/A","to":"null"}],"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":true},"tableColumn":"","targets":[{"expr":"avg by (service_name) (mysql_global_status_wsrep_flow_control_status{service_name=~\"$service_name\"})","format":"time_series","interval":"$interval","intervalFactor":1,"refId":"A"}],"thresholds":"0.5,1","title":"FC (normal traffic)","type":"singlestat","valueFontSize":"50%","valueMaps":[{"op":"=","text":"OFF","value":"0"},{"op":"=","text":"ON","value":"1"},{"op":"=","text":"N\/A","value":"null"}],"valueName":"current"},{"aliasColors":{"Maximum":"#806eb7","Standard Deviation":"#7eb26d"},"bars":true,"dashLength":10,"dashes":false,"datasource":"DS_PROMETHEUS","decimals":2,"description":"Shows figures for the replication latency on group communication. It measures latency from the time point when a message is sent out to the time point when a message is received. As replication is a group operation, this essentially gives you the slowest ACK and longest RTT in the cluster.","editable":true,"error":false,"fieldConfig":{"defaults":{"custom":{},"links":[]},"overrides":[]},"fill":0,"fillGradient":0,"grid":{},"gridPos":{"h":8,"w":24,"x":0,"y":4},"hiddenSeries":false,"id":42,"legend":{"alignAsTable":true,"avg":true,"current":false,"hideZero":false,"max":true,"min":true,"rightSide":true,"show":true,"sort":"avg","sortDesc":true,"total":false,"values":true},"lines":false,"linewidth":2,"links":[{"title":"Galera Documentation","url":"http:\/\/galeracluster.com\/documentation-webpages\/galerastatusvariables.html#wsrep-evs-repl-latency"}],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.4.3","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"avg by (service_name,aggregator) (max_over_time(mysql_global_status_wsrep_evs_repl_latency{service_name=~\"$service_name\", aggregator=\"Maximum\"}[$interval]) or\nmax_over_time(mysql_global_status_wsrep_evs_repl_latency{service_name=~\"$service_name\", aggregator=\"Maximum\"}[5m]))","format":"time_series","interval":"$interval","intervalFactor":1,"legendFormat":"{{ aggregator }}","refId":"A","step":300},{"expr":"avg by (service_name,aggregator) (avg_over_time(mysql_global_status_wsrep_evs_repl_latency{service_name=~\"$service_name\", aggregator=\"Standard Deviation\"}[$interval]) or\navg_over_time(mysql_global_status_wsrep_evs_repl_latency{service_name=~\"$service_name\", aggregator=\"Standard Deviation\"}[5m]))","format":"time_series","interval":"$interval","intervalFactor":1,"legendFormat":"{{ aggregator }}","refId":"B","step":300},{"expr":"avg by (service_name,aggregator) (avg_over_time(mysql_global_status_wsrep_evs_repl_latency{service_name=~\"$service_name\", aggregator=\"Average\"}[$interval]) or\navg_over_time(mysql_global_status_wsrep_evs_repl_latency{service_name=~\"$service_name\", aggregator=\"Average\"}[5m]))","format":"time_series","interval":"$interval","intervalFactor":1,"legendFormat":"{{ aggregator }}","refId":"C","step":300},{"expr":"avg by (service_name,aggregator) (min_over_time(mysql_global_status_wsrep_evs_repl_latency{service_name=~\"$service_name\", aggregator=\"Minimum\"}[$interval]) or\nmin_over_time(mysql_global_status_wsrep_evs_repl_latency{service_name=~\"$service_name\", aggregator=\"Minimum\"}[5m]))","format":"time_series","interval":"$interval","intervalFactor":1,"legendFormat":"{{ aggregator }}","refId":"D","step":300}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Galera Replication Latency","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":2,"format":"s","label":"","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":"","logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"DS_PROMETHEUS","decimals":2,"description":"Shows the length of receive and send queues.","editable":true,"error":false,"fieldConfig":{"defaults":{"custom":{},"links":[]},"overrides":[]},"fill":2,"fillGradient":0,"grid":{},"gridPos":{"h":8,"w":12,"x":0,"y":12},"hiddenSeries":false,"id":39,"legend":{"alignAsTable":true,"avg":true,"current":false,"max":true,"min":true,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.4.3","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"calculatedInterval":"2m","datasourceErrors":{},"errors":{},"expr":"avg by (service_name) (max_over_time(mysql_global_status_wsrep_local_recv_queue{service_name=~\"$service_name\"}[$interval]) or\nmax_over_time(mysql_global_status_wsrep_local_recv_queue{service_name=~\"$service_name\"}[5m]))","format":"time_series","interval":"$interval","intervalFactor":1,"legendFormat":"Receive Queue","metric":"","refId":"A","step":300},{"calculatedInterval":"2m","datasourceErrors":{},"errors":{},"expr":"avg by (service_name) (max_over_time(mysql_global_status_wsrep_local_send_queue{service_name=~\"$service_name\"}[$interval]) or\nmax_over_time(mysql_global_status_wsrep_local_send_queue{service_name=~\"$service_name\"}[5m]))","format":"time_series","interval":"$interval","intervalFactor":1,"legendFormat":"Send Queue","metric":"","refId":"B","step":300,"target":""}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Galera Replication Queues","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":3,"format":"short","logBase":1,"max":null,"min":0,"show":true},{"format":"short","logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"DS_PROMETHEUS","decimals":0,"description":"Shows the number of members currently connected to the cluster.","editable":true,"error":false,"fieldConfig":{"defaults":{"custom":{},"links":[]},"overrides":[]},"fill":0,"fillGradient":0,"grid":{},"gridPos":{"h":8,"w":12,"x":12,"y":12},"hiddenSeries":false,"id":54,"legend":{"alignAsTable":true,"avg":true,"current":false,"max":true,"min":true,"show":true,"sort":"avg","sortDesc":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.4.3","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"calculatedInterval":"2m","datasourceErrors":{},"errors":{},"expr":"avg by (service_name) (max_over_time(mysql_global_status_wsrep_cluster_size{service_name=~\"$service_name\"}[$interval]) or\nmax_over_time(mysql_global_status_wsrep_cluster_size{service_name=~\"$service_name\"}[5m]))","format":"time_series","interval":"$interval","intervalFactor":1,"legendFormat":"Size","metric":"","refId":"C","step":300,"target":""}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Galera Cluster Size","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":0,"format":"short","logBase":1,"max":null,"min":0,"show":true},{"format":"short","logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"DS_PROMETHEUS","decimals":2,"description":"Shows the number of FC_PAUSE events sent\/received. They are sent by a node when its replication queue gets too full. If a node is sending out FC messages it indicates a problem.","editable":true,"error":false,"fieldConfig":{"defaults":{"custom":{},"links":[]},"overrides":[]},"fill":0,"fillGradient":0,"grid":{},"gridPos":{"h":8,"w":12,"x":0,"y":20},"hiddenSeries":false,"id":45,"legend":{"alignAsTable":true,"avg":true,"current":false,"max":true,"min":true,"show":true,"sort":"avg","sortDesc":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.4.3","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"Paused due to Flow Control","linewidth":1,"yaxis":2}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"calculatedInterval":"2m","datasourceErrors":{},"errors":{},"expr":"avg by (service_name) (rate(mysql_global_status_wsrep_flow_control_recv{service_name=~\"$service_name\"}[$interval]) or irate(mysql_global_status_wsrep_flow_control_recv{service_name=~\"$service_name\"}[5m]))","format":"time_series","interval":"$interval","intervalFactor":1,"legendFormat":"FC Messages Received","metric":"","refId":"A","step":300},{"calculatedInterval":"2m","datasourceErrors":{},"errors":{},"expr":"avg by (service_name) (rate(mysql_global_status_wsrep_flow_control_sent{service_name=~\"$service_name\"}[$interval]) or irate(mysql_global_status_wsrep_flow_control_sent{service_name=~\"$service_name\"}[5m]))","format":"time_series","interval":"$interval","intervalFactor":1,"legendFormat":"FC Messages Sent","metric":"","refId":"B","step":300,"target":""},{"calculatedInterval":"2m","datasourceErrors":{},"errors":{},"expr":"avg by (service_name) ((rate(mysql_global_status_wsrep_flow_control_paused_ns{service_name=~\"$service_name\"}[$interval]) or irate(mysql_global_status_wsrep_flow_control_paused_ns{service_name=~\"$service_name\"}[5m])))\/1000000000","format":"time_series","interval":"$interval","intervalFactor":1,"legendFormat":"Paused due to Flow Control","metric":"","refId":"C","step":300,"target":""}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Galera Flow Control","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":2,"format":"short","logBase":1,"max":null,"min":0,"show":true},{"decimals":2,"format":"percentunit","logBase":1,"max":1,"min":0,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"DS_PROMETHEUS","decimals":2,"description":"Shows the average distances between highest and lowest seqno that are concurrently applied, committed and can be possibly applied in parallel (potential degree of parallelization).","editable":true,"error":false,"fieldConfig":{"defaults":{"custom":{},"links":[]},"overrides":[]},"fill":0,"fillGradient":0,"grid":{},"gridPos":{"h":8,"w":12,"x":12,"y":20},"hiddenSeries":false,"id":40,"legend":{"alignAsTable":true,"avg":true,"current":false,"max":true,"min":true,"show":true,"sort":"avg","sortDesc":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.4.3","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"calculatedInterval":"2m","datasourceErrors":{},"errors":{},"expr":"avg by (service_name) (max_over_time(mysql_global_status_wsrep_apply_window{service_name=~\"$service_name\"}[$interval]) or\nmax_over_time(mysql_global_status_wsrep_apply_window{service_name=~\"$service_name\"}[5m]))","format":"time_series","interval":"$interval","intervalFactor":1,"legendFormat":"Apply Window","metric":"","refId":"A","step":300},{"calculatedInterval":"2m","datasourceErrors":{},"errors":{},"expr":"avg by (service_name) (max_over_time(mysql_global_status_wsrep_commit_window{service_name=~\"$service_name\"}[$interval]) or\nmax_over_time(mysql_global_status_wsrep_commit_window{service_name=~\"$service_name\"}[5m]))","format":"time_series","interval":"$interval","intervalFactor":1,"legendFormat":"Commit Window","metric":"","refId":"B","step":300,"target":""},{"calculatedInterval":"2m","datasourceErrors":{},"errors":{},"expr":"avg by (service_name) (max_over_time(mysql_global_status_wsrep_cert_deps_distance{service_name=~\"$service_name\"}[$interval]) or\nmax_over_time(mysql_global_status_wsrep_cert_deps_distance{service_name=~\"$service_name\"}[5m]))","format":"time_series","interval":"$interval","intervalFactor":1,"legendFormat":"Cert Deps Distance","metric":"","refId":"C","step":300,"target":""}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Galera Parallelization Efficiency","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":2,"format":"short","logBase":1,"max":null,"min":0,"show":true},{"format":"short","logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"DS_PROMETHEUS","decimals":2,"description":"Shows the number of local transactions being committed on this node that failed certification (some other node had a commit that conflicted with ours) \u2013 client received deadlock error on commit and also the number of local transactions in flight on this node that were aborted because they locked something an applier thread needed \u2013 deadlock error anywhere in an open transaction. Spikes in the graph may indicate writing to the same table potentially the same rows from 2 nodes.","editable":true,"error":false,"fieldConfig":{"defaults":{"custom":{},"links":[]},"overrides":[]},"fill":2,"fillGradient":0,"grid":{},"gridPos":{"h":8,"w":12,"x":0,"y":28},"hiddenSeries":false,"id":41,"legend":{"alignAsTable":true,"avg":true,"current":false,"max":true,"min":true,"show":true,"sort":"avg","sortDesc":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"null","percentage":false,"pluginVersion":"7.4.3","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"calculatedInterval":"2m","datasourceErrors":{},"errors":{},"expr":"avg by (service_name) (rate(mysql_global_status_wsrep_local_cert_failures{service_name=~\"$service_name\"}[$interval]) or irate(mysql_global_status_wsrep_local_cert_failures{service_name=~\"$service_name\"}[5m]))","interval":"$interval","intervalFactor":1,"legendFormat":"Local Cert Failures","metric":"","refId":"A","step":300},{"calculatedInterval":"2m","datasourceErrors":{},"errors":{},"expr":"avg by (service_name) (rate(mysql_global_status_wsrep_local_bf_aborts{service_name=~\"$service_name\"}[$interval]) or irate(mysql_global_status_wsrep_local_bf_aborts{service_name=~\"$service_name\"}[5m]))","interval":"$interval","intervalFactor":1,"legendFormat":"Local Bf Aborts","metric":"","refId":"B","step":300,"target":""}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Galera Writing Conflicts","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":2,"format":"ops","logBase":1,"max":null,"min":0,"show":true},{"format":"ops","logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"DS_PROMETHEUS","decimals":2,"description":"Shows for how long the node can be taken out of the cluster before SST is required. SST is a full state transfer method.","editable":true,"error":false,"fieldConfig":{"defaults":{"custom":{},"links":[]},"overrides":[]},"fill":2,"fillGradient":0,"grid":{},"gridPos":{"h":8,"w":12,"x":12,"y":28},"hiddenSeries":false,"id":47,"legend":{"alignAsTable":true,"avg":true,"current":false,"max":true,"min":true,"show":true,"sort":"avg","sortDesc":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"null","percentage":false,"pluginVersion":"7.4.3","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"Time (Instant)","color":"#447ebc","lines":false,"pointradius":1,"points":true}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"calculatedInterval":"2m","datasourceErrors":{},"errors":{},"expr":"avg by (service_name) (mysql_galera_gcache_size_bytes{service_name=~\"$service_name\"}) \/\nignoring(job) (avg by (service_name) (rate(mysql_global_status_wsrep_replicated_bytes{service_name=~\"$service_name\"}[1h])+rate(mysql_global_status_wsrep_received_bytes{service_name=~\"$service_name\"}[1h])))","format":"time_series","interval":"1h","intervalFactor":1,"legendFormat":"Time (1h avg)","metric":"","refId":"A","step":300},{"expr":"avg by (service_name) (mysql_galera_gcache_size_bytes{service_name=~\"$service_name\"}) \/\nignoring(job) (avg by (service_name) ((rate(mysql_global_status_wsrep_replicated_bytes{service_name=~\"$service_name\"}[$interval]) or irate(mysql_global_status_wsrep_replicated_bytes{service_name=~\"$service_name\"}[5m])) + \n(rate(mysql_global_status_wsrep_received_bytes{service_name=~\"$service_name\"}[$interval]) or irate(mysql_global_status_wsrep_received_bytes{service_name=~\"$service_name\"}[5m]))))","format":"time_series","hide":false,"interval":"$interval","intervalFactor":1,"legendFormat":"Time (Instant)","refId":"B"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Available Downtime before SST Required","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":2,"format":"s","logBase":1,"max":null,"min":0,"show":true},{"format":"short","logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"DS_PROMETHEUS","decimals":2,"description":"Shows the count of transactions received from the cluster (any other node) and replicated to the cluster (from this node).","editable":true,"error":false,"fieldConfig":{"defaults":{"custom":{},"links":[]},"overrides":[]},"fill":2,"fillGradient":0,"grid":{},"gridPos":{"h":8,"w":12,"x":0,"y":36},"hiddenSeries":false,"id":2,"legend":{"alignAsTable":true,"avg":true,"current":false,"max":true,"min":true,"show":true,"sort":"avg","sortDesc":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"null","percentage":false,"pluginVersion":"7.4.3","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"calculatedInterval":"2m","datasourceErrors":{},"errors":{},"expr":"avg by (service_name) (rate(mysql_global_status_wsrep_received{service_name=~\"$service_name\"}[$interval]) or irate(mysql_global_status_wsrep_received{service_name=~\"$service_name\"}[5m]))","interval":"$interval","intervalFactor":1,"legendFormat":"Transactions Received","metric":"","refId":"A","step":300},{"calculatedInterval":"2m","datasourceErrors":{},"errors":{},"expr":"avg by (service_name) (rate(mysql_global_status_wsrep_replicated{service_name=~\"$service_name\"}[$interval]) or irate(mysql_global_status_wsrep_replicated{service_name=~\"$service_name\"}[5m]))","interval":"$interval","intervalFactor":1,"legendFormat":"Transactions Replicated","metric":"","refId":"B","step":300,"target":""}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Galera Writeset Count","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":2,"format":"short","logBase":1,"max":null,"min":0,"show":true},{"format":"short","logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"DS_PROMETHEUS","decimals":2,"description":"Shows the average transaction size received\/replicated.","editable":true,"error":false,"fieldConfig":{"defaults":{"custom":{},"links":[]},"overrides":[]},"fill":2,"fillGradient":0,"grid":{},"gridPos":{"h":8,"w":12,"x":12,"y":36},"hiddenSeries":false,"id":11,"legend":{"alignAsTable":true,"avg":true,"current":false,"max":true,"min":true,"rightSide":false,"show":true,"sort":"avg","sortDesc":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"null","percentage":false,"pluginVersion":"7.4.3","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"calculatedInterval":"2m","datasourceErrors":{},"errors":{},"expr":"avg by (service_name) (rate(mysql_global_status_wsrep_received_bytes{service_name=~\"$service_name\"}[$interval]) \/ rate(mysql_global_status_wsrep_received{service_name=~\"$service_name\"}[$interval]) or irate(mysql_global_status_wsrep_received_bytes{service_name=~\"$service_name\"}[5m]) \/ irate(mysql_global_status_wsrep_received{service_name=~\"$service_name\"}[5m]))","interval":"$interval","intervalFactor":1,"legendFormat":"Incoming Transaction Size","metric":"","refId":"C","step":300},{"calculatedInterval":"2m","datasourceErrors":{},"errors":{},"expr":"avg by (service_name) (rate(mysql_global_status_wsrep_replicated_bytes{service_name=~\"$service_name\"}[$interval]) \/ rate(mysql_global_status_wsrep_replicated{service_name=~\"$service_name\"}[$interval]) or irate(mysql_global_status_wsrep_replicated_bytes{service_name=~\"$service_name\"}[5m]) \/ irate(mysql_global_status_wsrep_replicated{service_name=~\"$service_name\"}[5m]))","interval":"$interval","intervalFactor":1,"legendFormat":"Replicating Transaction Size","metric":"","refId":"A","step":300}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Galera Writeset Size","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":2,"format":"bytes","logBase":1,"max":null,"min":0,"show":true},{"format":"short","logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"DS_PROMETHEUS","decimals":2,"description":"Shows the bytes of data received from the cluster (any other node) and replicated to the cluster (from this node).","editable":true,"error":false,"fieldConfig":{"defaults":{"custom":{},"links":[]},"overrides":[]},"fill":6,"fillGradient":0,"grid":{},"gridPos":{"h":8,"w":12,"x":0,"y":44},"hiddenSeries":false,"id":9,"legend":{"alignAsTable":true,"avg":true,"current":false,"max":true,"min":true,"rightSide":false,"show":true,"sort":"avg","sortDesc":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"null","percentage":false,"pluginVersion":"7.4.3","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":true,"steppedLine":false,"targets":[{"calculatedInterval":"2m","datasourceErrors":{},"errors":{},"expr":"avg by (service_name) (rate(mysql_global_status_wsrep_received_bytes{service_name=~\"$service_name\"}[$interval]) or irate(mysql_global_status_wsrep_received_bytes{service_name=~\"$service_name\"}[5m]))","format":"time_series","interval":"$interval","intervalFactor":1,"legendFormat":"Inbound","metric":"","refId":"A","step":300},{"calculatedInterval":"2m","datasourceErrors":{},"errors":{},"expr":"avg by (service_name) (rate(mysql_global_status_wsrep_replicated_bytes{service_name=~\"$service_name\"}[$interval]) or irate(mysql_global_status_wsrep_replicated_bytes{service_name=~\"$service_name\"}[5m]))","format":"time_series","interval":"$interval","intervalFactor":1,"legendFormat":"Outbound","metric":"","refId":"B","step":300}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Galera Writeset Traffic","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":2,"format":"bytes","logBase":1,"max":null,"min":0,"show":true},{"format":"none","logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":true,"dashLength":10,"dashes":false,"datasource":"DS_PROMETHEUS","decimals":2,"description":"Shows the bytes of data received from the cluster (any other node) and replicated to the cluster (from this node).","editable":true,"error":false,"fieldConfig":{"defaults":{"custom":{},"links":[]},"overrides":[]},"fill":6,"fillGradient":0,"grid":{},"gridPos":{"h":8,"w":12,"x":12,"y":44},"hiddenSeries":false,"id":38,"legend":{"alignAsTable":true,"avg":true,"current":false,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":false,"linewidth":2,"links":[],"nullPointMode":"null","percentage":false,"pluginVersion":"7.4.3","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":true,"steppedLine":false,"targets":[{"calculatedInterval":"2m","datasourceErrors":{},"errors":{},"expr":"avg by (service_name) (increase(mysql_global_status_wsrep_received_bytes{service_name=~\"$service_name\"}[1h]))","interval":"1h","intervalFactor":1,"legendFormat":"Received","metric":"","refId":"A","step":3600},{"calculatedInterval":"2m","datasourceErrors":{},"errors":{},"expr":"avg by (service_name) (increase(mysql_global_status_wsrep_replicated_bytes{service_name=~\"$service_name\"}[1h]))","interval":"1h","intervalFactor":1,"legendFormat":"Replicated","metric":"","refId":"B","step":3600}],"thresholds":[],"timeFrom":"24h","timeRegions":[],"timeShift":null,"title":"Galera Network Usage Hourly","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":2,"format":"bytes","logBase":1,"max":null,"min":0,"show":true},{"format":"none","logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}}],"refresh":"5s","schemaVersion":27,"style":"dark","tags":[],"templating":{"list":[{"allFormat":"glob","auto":true,"auto_count":200,"auto_min":"1s","current":{"selected":false,"text":"auto","value":"$__auto_interval_interval"},"datasource":"DS_PROMETHEUS","description":null,"error":null,"hide":0,"includeAll":false,"label":"Interval","multi":false,"multiFormat":"glob","name":"interval","options":[{"selected":true,"text":"auto","value":"$__auto_interval_interval"},{"selected":false,"text":"1s","value":"1s"},{"selected":false,"text":"5s","value":"5s"},{"selected":false,"text":"1m","value":"1m"},{"selected":false,"text":"5m","value":"5m"},{"selected":false,"text":"1h","value":"1h"},{"selected":false,"text":"6h","value":"6h"},{"selected":false,"text":"1d","value":"1d"}],"query":"1s,5s,1m,5m,1h,6h,1d","refresh":2,"skipUrlSync":false,"type":"interval"},{"allValue":null,"current":{"selected":false,"text":"All","value":"$__all"},"datasource":"DS_PROMETHEUS","definition":"label_values(mysql_global_status_wsrep_local_state, node_name)","description":null,"error":null,"hide":2,"includeAll":true,"label":"Node","multi":true,"name":"node_name","options":[],"query":{"query":"label_values(mysql_global_status_wsrep_local_state, node_name)","refId":"DS_PROMETHEUS-node_name-Variable-Query"},"refresh":2,"regex":"","skipUrlSync":false,"sort":1,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false},{"allFormat":"glob","allValue":".*","current":{"selected":false,"text":"All","value":"$__all"},"datasource":"DS_PROMETHEUS","definition":"label_values(mysql_galera_variables_info, wsrep_cluster_name)","description":null,"error":null,"hide":0,"includeAll":true,"label":"Cluster","multi":true,"multiFormat":"regex values","name":"cluster","options":[],"query":{"query":"label_values(mysql_galera_variables_info, wsrep_cluster_name)","refId":"DS_PROMETHEUS-cluster-Variable-Query"},"refresh":2,"refresh_on_load":false,"regex":"","skipUrlSync":false,"sort":1,"tagValuesQuery":null,"tags":[],"tagsQuery":null,"type":"query","useTags":false},{"allFormat":"glob","allValue":null,"current":{"isNone":true,"selected":false,"text":"None","value":""},"datasource":"DS_PROMETHEUS","definition":"query_result(mysql_galera_variables_info{wsrep_cluster_name=~\"$cluster\"} * on(service_name) mysql_global_variables_wsrep_rsu_commit_timeout)","description":null,"error":null,"hide":0,"includeAll":false,"label":"Service Name","multi":false,"multiFormat":"regex values","name":"service_name","options":[],"query":{"query":"query_result(mysql_galera_variables_info{wsrep_cluster_name=~\"$cluster\"} * on(service_name) mysql_global_variables_wsrep_rsu_commit_timeout)","refId":"DS_PROMETHEUS-service_name-Variable-Query"},"refresh":2,"refresh_on_load":false,"regex":"\/\"([^\"]+)\"\/","skipUrlSync":false,"sort":1,"tagValuesQuery":null,"tags":[],"tagsQuery":null,"type":"query","useTags":false},{"allValue":".*","current":{"selected":false,"text":"All","value":"$__all"},"datasource":"DS_PROMETHEUS","definition":"label_values({__name__=~\"pg_up|mysql_up|mongodb_up|proxysql_mysql_status_active_transactions\"}, environment)","description":null,"error":null,"hide":2,"includeAll":true,"label":"Environment","multi":true,"name":"environment","options":[],"query":{"query":"label_values({__name__=~\"pg_up|mysql_up|mongodb_up|proxysql_mysql_status_active_transactions\"}, environment)","refId":"DS_PROMETHEUS-environment-Variable-Query"},"refresh":2,"regex":"","skipUrlSync":false,"sort":0,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false},{"allValue":null,"current":{"selected":false,"text":"All","value":"$__all"},"datasource":"DS_PROMETHEUS","definition":"label_values({__name__=~\"pg_up|mysql_up|mongodb_up|proxysql_mysql_status_active_transactions\"}, replication_set)","description":null,"error":null,"hide":2,"includeAll":true,"label":"Replication Set","multi":true,"name":"replication_set","options":[],"query":{"query":"label_values({__name__=~\"pg_up|mysql_up|mongodb_up|proxysql_mysql_status_active_transactions\"}, replication_set)","refId":"DS_PROMETHEUS-replication_set-Variable-Query"},"refresh":2,"regex":"","skipUrlSync":false,"sort":0,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false},{"allValue":null,"current":{"selected":false,"text":"All","value":"$__all"},"datasource":"DS_PROMETHEUS","definition":"label_values(pg_stat_database_tup_fetched{service_name=~\"$service_name\",datname!~\"template.*|postgres\"},datname)","description":null,"error":null,"hide":2,"includeAll":true,"label":"Database","multi":true,"name":"database","options":[],"query":{"query":"label_values(pg_stat_database_tup_fetched{service_name=~\"$service_name\",datname!~\"template.*|postgres\"},datname)","refId":"DS_PROMETHEUS-database-Variable-Query"},"refresh":1,"regex":"","skipUrlSync":false,"sort":0,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false},{"allValue":null,"current":{"selected":false,"text":"All","value":"$__all"},"datasource":"DS_PROMETHEUS","definition":"label_values({__name__=~\"pg_up|mysql_up|mongodb_up|proxysql_mysql_status_active_transactions\"}, node_type)","description":null,"error":null,"hide":2,"includeAll":true,"label":"Type","multi":true,"name":"node_type","options":[],"query":{"query":"label_values({__name__=~\"pg_up|mysql_up|mongodb_up|proxysql_mysql_status_active_transactions\"}, node_type)","refId":"DS_PROMETHEUS-node_type-Variable-Query"},"refresh":1,"regex":"","skipUrlSync":false,"sort":0,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false},{"allValue":null,"current":{"selected":false,"text":"All","value":"$__all"},"datasource":"DS_PROMETHEUS","definition":"label_values({__name__=~\"pg_up|mysql_up|mongodb_up|proxysql_mysql_status_active_transactions\"}, service_type)","description":null,"error":null,"hide":2,"includeAll":true,"label":"Type","multi":true,"name":"service_type","options":[],"query":{"query":"label_values({__name__=~\"pg_up|mysql_up|mongodb_up|proxysql_mysql_status_active_transactions\"}, service_type)","refId":"DS_PROMETHEUS-service_type-Variable-Query"},"refresh":1,"regex":"","skipUrlSync":false,"sort":0,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false},{"allValue":null,"current":{"selected":false,"text":"All","value":"$__all"},"datasource":"DS_PROMETHEUS","definition":"label_values({__name__=~\"pg_up|mysql_up|mongodb_up|proxysql_mysql_status_active_transactions\"}, schema)","description":null,"error":null,"hide":2,"includeAll":true,"label":"Schema","multi":true,"name":"schema","options":[],"query":{"query":"label_values({__name__=~\"pg_up|mysql_up|mongodb_up|proxysql_mysql_status_active_transactions\"}, schema)","refId":"DS_PROMETHEUS-schema-Variable-Query"},"refresh":1,"regex":"","skipUrlSync":false,"sort":0,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false}]},"time":{"from":"now-30m","to":"now"},"timepicker":{"collapse":false,"enable":true,"hidden":false,"notice":false,"now":true,"refresh_intervals":["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],"status":"Stable","time_options":["5m","15m","1h","6h","12h","24h","2d","7d","30d"],"type":"timepicker"},"timezone":"browser","title":"PXC\/Galera Node Summary","uid":null,"version":1}
  kafka_dashboard.json: |-
    {"annotations":{"list":[{"builtIn":1,"datasource":"-- Grafana --","enable":true,"hide":true,"iconColor":"rgba(0, 211, 255, 1)","limit":100,"name":"Annotations & Alerts","showIn":0,"type":"dashboard"},{"datasource":"DS_PROMETHEUS","enable":true,"expr":"litmuschaos_awaited_experiments{chaosresult_namespace=\"litmus\",endpoint=\"tcp\",job=\"chaos-exporter\",namespace=\"litmus\",service=\"chaos-exporter\"}","hide":false,"iconColor":"#C4162A","name":"LitmusChaos","showIn":0,"step":"10s"}]},"description":"KUDO Kafka Cluster Dashboard","editable":true,"gnetId":9018,"graphTooltip":0,"id":2,"iteration":1613544738229,"links":[],"panels":[{"collapsed":false,"datasource":null,"gridPos":{"h":1,"w":24,"x":0,"y":0},"id":139,"panels":[],"title":"Overview","type":"row"},{"aliasColors":{},"bars":false,"cacheTimeout":null,"dashLength":10,"dashes":false,"datasource":"DS_PROMETHEUS","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fill":2,"fillGradient":0,"gridPos":{"h":8,"w":12,"x":0,"y":1},"hiddenSeries":false,"id":147,"interval":null,"legend":{"alignAsTable":false,"avg":false,"current":false,"max":false,"min":false,"rightSide":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":2,"links":[],"maxDataPoints":100,"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.4.1","pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"kafka_brokers{namespace=\"$namespace\",service=\"kafka-exporter\"}","format":"time_series","instant":false,"interval":"","intervalFactor":1,"legendFormat":"","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Broker Count","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"$$hashKey":"object:2414","decimals":0,"format":"short","label":"","logBase":1,"max":"3","min":"0","show":true},{"$$hashKey":"object:2415","format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"cacheTimeout":null,"colorBackground":true,"colorPostfix":true,"colorValue":false,"colors":["#bf1b00","#bf1b00","#629e51"],"datasource":"DS_PROMETHEUS","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"format":"none","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":4,"w":4,"x":12,"y":1},"id":165,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N\/A","to":"null"}],"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"tableColumn":"","targets":[{"expr":"max(kafka_server_SessionExpireListener_ZooKeeperSyncConnects_total{service=\"$service\"})","format":"time_series","instant":true,"interval":"","intervalFactor":1,"refId":"A"}],"thresholds":"0,1","title":"Zookeeper Sync Connects \/ sec","type":"singlestat","valueFontSize":"80%","valueMaps":[{"op":"=","text":"0","value":"null"}],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":true,"colors":["#299c46","#962d82","#d44a3a"],"datasource":"DS_PROMETHEUS","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"format":"none","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":4,"w":4,"x":16,"y":1},"id":151,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N\/A","to":"null"}],"sparkline":{"fillColor":"#705da0","full":false,"lineColor":"#962d82","show":true},"tableColumn":"","targets":[{"expr":"max(kafka_server_ReplicaManager_LeaderCount{namespace=\"$namespace\",service=\"$service\"})","format":"time_series","instant":false,"intervalFactor":1,"refId":"A"}],"thresholds":"","title":"Total Leader Count","type":"singlestat","valueFontSize":"80%","valueMaps":[{"op":"=","text":"0","value":"null"}],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":true,"colors":["#299c46","#962d82","#d44a3a"],"datasource":"DS_PROMETHEUS","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"format":"none","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":4,"w":4,"x":20,"y":1},"id":167,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N\/A","to":"null"}],"sparkline":{"fillColor":"#705da0","full":false,"lineColor":"#962d82","show":true},"tableColumn":"","targets":[{"expr":"count(count by (topic) (kafka_server_BrokerTopicMetrics_MessagesIn_total{namespace=\"$namespace\",service=\"$service\"}))","format":"time_series","instant":false,"intervalFactor":1,"refId":"A"}],"thresholds":"","title":"Total Topic Count","type":"singlestat","valueFontSize":"80%","valueMaps":[{"op":"=","text":"0","value":"null"}],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":true,"colors":["#299c46","#962d82","#d44a3a"],"datasource":"DS_PROMETHEUS","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"format":"none","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":4,"w":4,"x":12,"y":5},"id":149,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N\/A","to":"null"}],"sparkline":{"fillColor":"#705da0","full":false,"lineColor":"#962d82","show":true},"tableColumn":"","targets":[{"expr":"max(kafka_server_ReplicaManager_PartitionCount{namespace=\"$namespace\",service=\"$service\"})","format":"time_series","instant":false,"intervalFactor":1,"refId":"A"}],"thresholds":"","title":"Total Partition Count","type":"singlestat","valueFontSize":"80%","valueMaps":[{"op":"=","text":"0","value":"null"}],"valueName":"current"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"DS_PROMETHEUS","decimals":0,"description":"The first node to boot in a Kafka cluster automatically becomes the controller, and there can be only one. The controller in a Kafka cluster is responsible for maintaining the list of partition leaders, and coordinating leadership transitions (in the event a partition leader becomes unavailable). If it becomes necessary to replace the controller, a new controller is randomly chosen by ZooKeeper from the pool of brokers. In general, it is not possible for this value to be greater than one, but you should definitely alert on a value of zero that lasts for more than a short period (< 1s) of time.","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fill":10,"fillGradient":0,"gridPos":{"h":4,"w":4,"x":16,"y":5},"hiddenSeries":false,"id":114,"legend":{"alignAsTable":true,"avg":false,"current":true,"hideEmpty":false,"hideZero":false,"max":false,"min":false,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":0,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.4.1","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":true,"targets":[{"expr":"sum(kafka_controller_KafkaController_ActiveControllerCount{namespace=\"$namespace\",service=\"$service\"})by(pod, service)","format":"time_series","intervalFactor":1,"legendFormat":"{{pod}}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"ActiveController for ($service)","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":"Active","logBase":1,"max":"1","min":"0","show":false},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"cacheTimeout":null,"colorBackground":false,"colorPostfix":true,"colorValue":true,"colors":["#37872D","#E0B400","#C4162A"],"datasource":"DS_PROMETHEUS","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"format":"none","gauge":{"maxValue":100,"minValue":0,"show":true,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":4,"w":4,"x":20,"y":5},"id":181,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"pluginVersion":"6.1.6","postfix":"%","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N\/A","to":"null"}],"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"tableColumn":"","targets":[{"expr":"100 * (node_filesystem_size_bytes{mountpoint=\"\/var\/lib\/kafka\",namespace=\"$namespace\",service=\"$service\",pod=\"$broker\"} - node_filesystem_avail_bytes{mountpoint=\"\/var\/lib\/kafka\",namespace=\"$namespace\",service=\"$service\",pod=\"$broker\"}) \/ node_filesystem_size_bytes{mountpoint=\"\/var\/lib\/kafka\",namespace=\"$namespace\",service=\"$service\",pod=\"$broker\"}","format":"time_series","instant":true,"intervalFactor":1,"legendFormat":"USED: {{$broker}}","refId":"B"}],"thresholds":"60,80,80","title":"Disk Usage: $broker","type":"singlestat","valueFontSize":"100%","valueMaps":[{"op":"=","text":"N\/A","value":"null"}],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":false,"colors":["#299c46","rgba(237, 129, 40, 0.89)","#d44a3a"],"datasource":"DS_PROMETHEUS","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"format":"percent","gauge":{"maxValue":100,"minValue":0,"show":true,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":4,"w":3,"x":0,"y":9},"id":161,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N\/A","to":"null"}],"sparkline":{"fillColor":"#705da0","full":false,"lineColor":"#962d82","show":false},"tableColumn":"","targets":[{"expr":"avg(kafka_network_SocketServer_NetworkProcessorAvgIdlePercent{namespace=\"$namespace\",service=\"$service\"})","format":"time_series","instant":true,"intervalFactor":1,"refId":"A"}],"thresholds":"50,80","title":"Request Handler Avg Load %","type":"singlestat","valueFontSize":"80%","valueMaps":[{"op":"=","text":"0","value":"null"}],"valueName":"current"},{"cacheTimeout":null,"colorBackground":true,"colorValue":false,"colors":["#629e51","#629e51","#bf1b00"],"datasource":"DS_PROMETHEUS","description":"In a healthy cluster, the number of in sync replicas (ISRs) should be exactly equal to the total number of replicas. If partition replicas fall too far behind their leaders, the follower partition is removed from the ISR pool, and you should see a corresponding increase in IsrShrinksPerSec. Since Kafka\u2019s high-availability guarantees cannot be met without replication, investigation is certainly warranted should this metric value exceed zero for extended time periods.\n\nIf this metric has a value greater than 1 it means that data is not being replicated to enough number of brokers thereby increasing the probability of data loss.","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"format":"none","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":4,"w":4,"x":3,"y":9},"id":142,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N\/A","to":"null"}],"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"#890f02","show":true},"tableColumn":"","targets":[{"expr":"sum(kafka_server_ReplicaManager_UnderReplicatedPartitions{service=\"$service\", namespace=\"$namespace\"})","format":"time_series","instant":false,"intervalFactor":1,"refId":"A"}],"thresholds":"0,1","title":"Under Replicated Partitions for $service","type":"singlestat","valueFontSize":"80%","valueMaps":[{"op":"=","text":"0","value":"null"}],"valueName":"current"},{"cacheTimeout":null,"colorBackground":true,"colorPostfix":true,"colorValue":false,"colors":["#bf1b00","#bf1b00","#629e51"],"datasource":"DS_PROMETHEUS","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"format":"none","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":4,"w":4,"x":7,"y":9},"id":164,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N\/A","to":"null"}],"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"tableColumn":"","targets":[{"expr":"sum(kafka_controller_KafkaController_ActiveControllerCount{namespace=\"$namespace\",service=\"$service\"})","format":"time_series","instant":true,"interval":"","intervalFactor":1,"refId":"A"}],"thresholds":"0,1","title":"Active Controller Count","type":"singlestat","valueFontSize":"80%","valueMaps":[{"op":"=","text":"0","value":"null"}],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":false,"colors":["#299c46","rgba(237, 129, 40, 0.89)","#d44a3a"],"datasource":"DS_PROMETHEUS","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"format":"none","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":4,"w":4,"x":11,"y":9},"id":144,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":" msg","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N\/A","to":"null"}],"sparkline":{"fillColor":"#614d93","full":false,"lineColor":"#962d82","show":true},"tableColumn":"","targets":[{"expr":"sum(kafka_server_BrokerTopicMetrics_MessagesIn_total{namespace=\"$namespace\",service=\"$service\", topic=\"\"})","format":"time_series","instant":false,"intervalFactor":1,"refId":"A"}],"thresholds":"","title":"Total Messages In","type":"singlestat","valueFontSize":"80%","valueMaps":[{"op":"=","text":"0","value":"null"}],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":false,"colors":["#299c46","rgba(237, 129, 40, 0.89)","#d44a3a"],"datasource":"DS_PROMETHEUS","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"format":"decbytes","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":4,"w":4,"x":15,"y":9},"id":145,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N\/A","to":"null"}],"sparkline":{"fillColor":"#614d93","full":false,"lineColor":"#962d82","show":true},"tableColumn":"","targets":[{"expr":"sum(kafka_server_BrokerTopicMetrics_BytesIn_total{namespace=\"$namespace\",service=\"$service\", topic=\"\"})","format":"time_series","intervalFactor":1,"refId":"A"}],"thresholds":"","title":"Total Messages In Size","type":"singlestat","valueFontSize":"80%","valueMaps":[{"op":"=","text":"0","value":"null"}],"valueName":"current"},{"columns":[],"datasource":null,"fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fontSize":"100%","gridPos":{"h":4,"w":5,"x":19,"y":9},"id":182,"links":[],"pageSize":null,"scroll":true,"showHeader":true,"sort":{"col":0,"desc":true},"styles":[{"alias":"Time","align":"auto","dateFormat":"YYYY-MM-DD HH:mm:ss","pattern":"Time","type":"date"},{"alias":"Disk Used","align":"auto","colorMode":"row","colors":["rgba(50, 172, 45, 0.97)","rgba(237, 129, 40, 0.89)","rgba(245, 54, 54, 0.9)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"mappingType":1,"pattern":"Value","thresholds":["60","80","80"],"type":"number","unit":"percent"},{"alias":"Broker: Mount Path","align":"auto","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"mappingType":1,"pattern":"Metric","thresholds":[],"type":"number","unit":"short"},{"alias":"","align":"auto","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"decimals":2,"pattern":"\/.*\/","thresholds":[],"type":"number","unit":"short"}],"targets":[{"expr":"100 * (node_filesystem_size_bytes{mountpoint=\"\/var\/lib\/kafka\",namespace=\"$namespace\",service=\"$service\"} - node_filesystem_avail_bytes{mountpoint=\"\/var\/lib\/kafka\",namespace=\"$namespace\",service=\"$service\"}) \/ node_filesystem_size_bytes{mountpoint=\"\/var\/lib\/kafka\",namespace=\"$namespace\",service=\"$service\"}","format":"time_series","instant":true,"intervalFactor":1,"legendFormat":"{{pod}}: {{mountpoint}}","refId":"A"}],"timeFrom":null,"timeShift":null,"title":"Disk Used \/ Broker","transform":"timeseries_to_rows","type":"table-old"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":null,"fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":8,"w":12,"x":0,"y":13},"hiddenSeries":false,"id":171,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.4.1","pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"jvm_memory_bytes_used{namespace=\"$namespace\",service=\"$service\"}","format":"time_series","intervalFactor":1,"legendFormat":"{{pod}} {{area}}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Memory Used \/ Broker","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"decbytes","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"decbytes","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"DS_PROMETHEUS","description":"Generally, disk throughput tends to be the main bottleneck in Kafka performance. However, that\u2019s not to say that the network is never a bottleneck. Depending on your use case, hardware, and configuration, the network can quickly become the slowest segment of a message\u2019s trip, especially if you are sending messages across data centers. Tracking network throughput on your brokers gives you more information as to where potential bottlenecks may lie, and can inform decisions like whether or not you should enable end-to-end compression of your messages.","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":8,"w":12,"x":12,"y":13},"hiddenSeries":false,"id":179,"legend":{"alignAsTable":true,"avg":false,"current":true,"max":false,"min":false,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.4.1","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":true,"steppedLine":false,"targets":[{"expr":"sum by(topic) (kafka_server_BrokerTopicMetrics_MessagesIn_total{namespace=\"$namespace\",service=\"$service\", topic=~\".+\"})","format":"time_series","interval":"15s","intervalFactor":1,"legendFormat":"{{topic}}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Messages \/ Topic","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"DS_PROMETHEUS","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":7,"w":12,"x":0,"y":21},"hiddenSeries":false,"id":174,"legend":{"alignAsTable":true,"avg":false,"current":true,"max":false,"min":false,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.4.1","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":true,"steppedLine":false,"targets":[{"expr":"sum(rate(kafka_server_BrokerTopicMetrics_MessagesIn_total{service=\"$service\", namespace=\"$namespace\", topic=\"\"}[1m]))","format":"time_series","intervalFactor":1,"legendFormat":"messages\/second","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"messages in \/ sec","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"DS_PROMETHEUS","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":8,"w":12,"x":12,"y":21},"hiddenSeries":false,"id":177,"legend":{"alignAsTable":true,"avg":false,"current":true,"max":false,"min":false,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.4.1","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":true,"steppedLine":false,"targets":[{"expr":"sum(rate(kafka_server_BrokerTopicMetrics_BytesIn_total{service=\"$service\", namespace=\"$namespace\", topic=\"\"}[1m]))","format":"time_series","intervalFactor":1,"legendFormat":"bytes in \/second","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"bytes in \/ sec","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"decbytes","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"DS_PROMETHEUS","description":"Generally, disk throughput tends to be the main bottleneck in Kafka performance. However, that\u2019s not to say that the network is never a bottleneck. Depending on your use case, hardware, and configuration, the network can quickly become the slowest segment of a message\u2019s trip, especially if you are sending messages across data centers. Tracking network throughput on your brokers gives you more information as to where potential bottlenecks may lie, and can inform decisions like whether or not you should enable end-to-end compression of your messages.","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":7,"w":12,"x":0,"y":28},"hiddenSeries":false,"id":172,"legend":{"alignAsTable":true,"avg":false,"current":true,"max":false,"min":false,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.4.1","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":true,"steppedLine":false,"targets":[{"expr":"sum(kafka_server_BrokerTopicMetrics_BytesIn_total{namespace=\"$namespace\",service=\"$service\", topic=\"\"})","format":"time_series","interval":"15s","intervalFactor":1,"legendFormat":"{{pod}}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"All Bytes In","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"Bps","label":null,"logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"DS_PROMETHEUS","description":"Generally, disk throughput tends to be the main bottleneck in Kafka performance. However, that\u2019s not to say that the network is never a bottleneck. Depending on your use case, hardware, and configuration, the network can quickly become the slowest segment of a message\u2019s trip, especially if you are sending messages across data centers. Tracking network throughput on your brokers gives you more information as to where potential bottlenecks may lie, and can inform decisions like whether or not you should enable end-to-end compression of your messages.","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":7,"w":12,"x":12,"y":29},"hiddenSeries":false,"id":173,"legend":{"alignAsTable":true,"avg":false,"current":true,"max":false,"min":false,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.4.1","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum(kafka_server_BrokerTopicMetrics_BytesOut_total{namespace=\"$namespace\",service=\"$service\", topic=\"\"})","format":"time_series","intervalFactor":1,"legendFormat":"{{pod}}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"All Bytes Out","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"Bps","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"collapsed":true,"datasource":null,"gridPos":{"h":1,"w":24,"x":0,"y":36},"id":40,"panels":[{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"DS_PROMETHEUS","decimals":0,"description":"The first node to boot in a Kafka cluster automatically becomes the controller, and there can be only one. The controller in a Kafka cluster is responsible for maintaining the list of partition leaders, and coordinating leadership transitions (in the event a partition leader becomes unavailable). If it becomes necessary to replace the controller, a new controller is randomly chosen by ZooKeeper from the pool of brokers. In general, it is not possible for this value to be greater than one, but you should definitely alert on a value of zero that lasts for more than a short period (< 1s) of time.","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":7,"w":8,"x":0,"y":2},"hiddenSeries":false,"id":117,"legend":{"alignAsTable":true,"avg":false,"current":true,"max":false,"min":false,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.4.1","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"(kafka_controller_KafkaController_GlobalPartitionCount{namespace=\"$namespace\",service=\"$service\",pod=~\"$broker\"})","format":"time_series","intervalFactor":1,"legendFormat":"{{pod}}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Total Partition Count (Broker) for ($service) broker ($broker)","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"DS_PROMETHEUS","decimals":0,"description":"The number of in-sync replicas (ISRs) for a particular partition should remain fairly static, the only exceptions are when you are expanding your broker cluster or removing partitions. In order to maintain high availability, a healthy Kafka cluster requires a minimum number of ISRs for failover. A replica could be removed from the ISR pool for a couple of reasons: it is too far behind the leader\u2019s offset (user-configurable by setting the replica.lag.max.messages configuration parameter), or it has not contacted the leader for some time (configurable with the replica.socket.timeout.ms parameter). No matter the reason, an increase in IsrShrinksPerSec without a corresponding increase in IsrExpandsPerSec shortly thereafter is cause for concern and requires user intervention.The Kafka documentation provides a wealth of information on the user-configurable parameters for brokers.","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":7,"w":8,"x":8,"y":2},"hiddenSeries":false,"id":119,"legend":{"alignAsTable":true,"avg":false,"current":true,"max":false,"min":false,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.4.1","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"(kafka_server_ReplicaManager_IsrShrinks_total{namespace=\"$namespace\",service=\"$service\",pod=~\"$broker\"})","format":"time_series","intervalFactor":1,"legendFormat":"{{pod}}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"ISR Shrink Rate (Broker) for ($service) broker ($broker)","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"DS_PROMETHEUS","decimals":0,"description":"This value should be 0","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":7,"w":8,"x":16,"y":2},"hiddenSeries":false,"id":116,"legend":{"alignAsTable":true,"avg":false,"current":true,"max":false,"min":false,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.4.1","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum(kafka_controller_KafkaController_OfflinePartitionsCount{namespace=\"$namespace\",service=\"$service\",pod=~\"$broker\"})by(pod)","format":"time_series","intervalFactor":1,"legendFormat":"{{pod}}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Offline Partitions for ($service) broker ($broker)","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"DS_PROMETHEUS","decimals":0,"description":"Number of requests waiting in the producer purgatory. This should be non-zero when acks=all is used on the producer.","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":7,"w":8,"x":0,"y":9},"hiddenSeries":false,"id":120,"legend":{"alignAsTable":true,"avg":false,"current":true,"max":false,"min":false,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.4.1","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum(kafka_server_DelayedOperationPurgatory_NumDelayedOperations{namespace=\"$namespace\",service=\"$service\",pod=~\"$broker\"})by(pod)","format":"time_series","intervalFactor":1,"legendFormat":"{{pod}}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Producer Purgatory Requests Waiting for ($service) broker ($broker)","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"DS_PROMETHEUS","decimals":0,"description":"The number of in-sync replicas (ISRs) for a particular partition should remain fairly static, the only exceptions are when you are expanding your broker cluster or removing partitions. In order to maintain high availability, a healthy Kafka cluster requires a minimum number of ISRs for failover. A replica could be removed from the ISR pool for a couple of reasons: it is too far behind the leader\u2019s offset (user-configurable by setting the replica.lag.max.messages configuration parameter), or it has not contacted the leader for some time (configurable with the replica.socket.timeout.ms parameter). No matter the reason, an increase in IsrShrinksPerSec without a corresponding increase in IsrExpandsPerSec shortly thereafter is cause for concern and requires user intervention.The Kafka documentation provides a wealth of information on the user-configurable parameters for brokers.","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":7,"w":8,"x":8,"y":9},"hiddenSeries":false,"id":118,"legend":{"alignAsTable":true,"avg":false,"current":true,"max":false,"min":false,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.4.1","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"kafka_server_ReplicaManager_IsrExpands_total{namespace=\"$namespace\",service=\"$service\",pod=~\"$broker\"}","format":"time_series","intervalFactor":1,"legendFormat":"{{pod}}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"ISR Expansion Rate (Broker) for ($service) broker ($broker)","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"DS_PROMETHEUS","decimals":0,"description":"","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":7,"w":8,"x":16,"y":9},"hiddenSeries":false,"id":121,"legend":{"alignAsTable":true,"avg":false,"current":true,"max":false,"min":false,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.4.1","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum(kafka_server_DelayedOperationPurgatory_PurgatorySize{namespace=\"$namespace\",service=\"$service\",pod=~\"$broker\"})by(pod)","format":"time_series","intervalFactor":1,"legendFormat":"{{pod}}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Delayed Fetch Operation Purgatory Size for ($service) broker ($broker)","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"decbytes","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"DS_PROMETHEUS","description":"Number of partitions on this broker. This should be mostly even across all brokers.","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":7,"w":12,"x":0,"y":16},"hiddenSeries":false,"id":60,"legend":{"alignAsTable":true,"avg":false,"current":true,"max":false,"min":false,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.4.1","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":true,"steppedLine":false,"targets":[{"expr":"(kafka_server_ReplicaManager_PartitionCount{namespace=\"$namespace\",service=\"$service\",pod=~\"$broker\"})","format":"time_series","intervalFactor":1,"legendFormat":"{{pod}}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Partition Count Across Brokers for ($service) broker ($broker)","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"DS_PROMETHEUS","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":7,"w":12,"x":12,"y":16},"hiddenSeries":false,"id":135,"legend":{"alignAsTable":true,"avg":false,"current":true,"max":false,"min":false,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.4.1","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":true,"steppedLine":false,"targets":[{"expr":"rate(kafka_server_BrokerTopicMetrics_MessagesIn_total{namespace=\"$namespace\", service=\"$service\", pod=~\"$broker\", topic=~\".+\"}[2m])","format":"time_series","intervalFactor":1,"legendFormat":"{{topic}}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Derivative messages\/sec for ($broker) \/ topic","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"DS_PROMETHEUS","description":"Generally, disk throughput tends to be the main bottleneck in Kafka performance. However, that\u2019s not to say that the network is never a bottleneck. Depending on your use case, hardware, and configuration, the network can quickly become the slowest segment of a message\u2019s trip, especially if you are sending messages across data centers. Tracking network throughput on your brokers gives you more information as to where potential bottlenecks may lie, and can inform decisions like whether or not you should enable end-to-end compression of your messages.","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":7,"w":12,"x":0,"y":23},"hiddenSeries":false,"id":20,"legend":{"alignAsTable":true,"avg":false,"current":true,"max":false,"min":false,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.4.1","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":true,"steppedLine":false,"targets":[{"expr":"(kafka_server_BrokerTopicMetrics_BytesIn_total{namespace=\"$namespace\",service=\"$service\",pod=~\"$broker\", topic=~\".+\"})","format":"time_series","interval":"15s","intervalFactor":1,"legendFormat":"{{topic}}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"All Bytes In per (Broker) for ($service) broker ($broker)","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"Bps","label":null,"logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"DS_PROMETHEUS","description":"Generally, disk throughput tends to be the main bottleneck in Kafka performance. However, that\u2019s not to say that the network is never a bottleneck. Depending on your use case, hardware, and configuration, the network can quickly become the slowest segment of a message\u2019s trip, especially if you are sending messages across data centers. Tracking network throughput on your brokers gives you more information as to where potential bottlenecks may lie, and can inform decisions like whether or not you should enable end-to-end compression of your messages.","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":7,"w":12,"x":12,"y":23},"hiddenSeries":false,"id":22,"legend":{"alignAsTable":true,"avg":false,"current":true,"max":false,"min":false,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.4.1","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"(kafka_server_BrokerTopicMetrics_BytesOut_total{namespace=\"$namespace\",service=\"$service\",pod=~\"$broker\", topic=~\".+\"})","format":"time_series","intervalFactor":1,"legendFormat":"{{topic}}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"All Bytes Out per (Broker) for ($service) broker ($broker)","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"Bps","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"DS_PROMETHEUS","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":8,"w":12,"x":0,"y":30},"hiddenSeries":false,"id":178,"legend":{"alignAsTable":true,"avg":false,"current":true,"max":false,"min":false,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.4.1","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":true,"steppedLine":false,"targets":[{"expr":"sum(rate(kafka_server_BrokerTopicMetrics_BytesIn_total{namespace=\"$namespace\",service=\"$service\",pod=~\"$broker\"}[1m]))","format":"time_series","intervalFactor":1,"legendFormat":"{{ $broker }} - bytes in \/second ","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"bytes in \/ sec","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"decbytes","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"columns":[],"datasource":"DS_PROMETHEUS","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fontSize":"100%","gridPos":{"h":8,"w":12,"x":12,"y":30},"id":153,"links":[],"pageSize":null,"scroll":true,"showHeader":true,"sort":{"col":1,"desc":false},"styles":[{"alias":"Time","align":"auto","dateFormat":"YYYY-MM-DD HH:mm:ss","pattern":"Time","type":"date"},{"alias":"","align":"auto","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"decimals":2,"pattern":"\/^(__name__|container_id|dcos_cluster_id|dcos_cluster_name|namespace|fault_domain_region|fault_domain_zone|host|instance|job|metric_type|service|Time)$\/","thresholds":[],"type":"hidden","unit":"short"},{"alias":"Count","align":"auto","colorMode":"cell","colors":["#7eb26d","#7eb26d","#bf1b00"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"mappingType":1,"pattern":"Value","thresholds":["0","1"],"type":"number","unit":"short"}],"targets":[{"expr":"sum by(topic) (kafka_cluster_Partition_UnderReplicated{namespace=\"$namespace\",namespace=\"$namespace\",service=\"$service\"})","format":"table","instant":true,"intervalFactor":1,"legendFormat":"","refId":"A"}],"title":"Under Replicated Partitions","transform":"table","type":"table-old"},{"aliasColors":{"TOTAL: kafka-kafka-0":"dark-green","TOTAL: kafka-kafka-1":"dark-green","TOTAL: kafka-kafka-2":"dark-green","TOTAL: kafka-kafka-3":"dark-green","TOTAL: kafka-kafka-4":"dark-green","TOTAL: kafka-kafka-5":"dark-green","USED: kafka-kafka-0":"dark-red","USED: kafka-kafka-1":"dark-red","USED: kafka-kafka-2":"dark-red","USED: kafka-kafka-3":"dark-red","USED: kafka-kafka-4":"dark-red","USED: kafka-kafka-5":"dark-red"},"bars":false,"cacheTimeout":null,"dashLength":10,"dashes":false,"datasource":"DS_PROMETHEUS","description":"Generally, disk throughput tends to be the main bottleneck in Kafka performance. However, that\u2019s not to say that the network is never a bottleneck. Depending on your use case, hardware, and configuration, the network can quickly become the slowest segment of a message\u2019s trip, especially if you are sending messages across data centers. Tracking network throughput on your brokers gives you more information as to where potential bottlenecks may lie, and can inform decisions like whether or not you should enable end-to-end compression of your messages.","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fill":8,"fillGradient":0,"gridPos":{"h":8,"w":24,"x":0,"y":38},"hiddenSeries":false,"id":180,"legend":{"alignAsTable":true,"avg":false,"current":true,"max":false,"min":false,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":true,"pluginVersion":"7.4.1","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"node_filesystem_size_bytes{mountpoint=\"\/var\/lib\/kafka\",namespace=\"$namespace\",service=\"$service\",pod=\"$broker\"}","format":"time_series","instant":false,"interval":"","intervalFactor":1,"legendFormat":"TOTAL: {{pod}}","refId":"B"},{"expr":"node_filesystem_size_bytes{mountpoint=\"\/var\/lib\/kafka\",namespace=\"$namespace\",service=\"$service\",pod=\"$broker\"} - node_filesystem_avail_bytes{mountpoint=\"\/var\/lib\/kafka\",namespace=\"$namespace\",service=\"$service\",pod=\"$broker\"}","format":"time_series","instant":false,"intervalFactor":1,"legendFormat":"USED: {{pod}}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Disk Usage","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"Bps","label":null,"logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}],"yaxis":{"align":false,"alignLevel":null}}],"title":"Broker Info","type":"row"}],"refresh":"5s","schemaVersion":27,"style":"dark","tags":[],"templating":{"list":[{"allValue":null,"current":{"selected":false,"text":"kafka","value":"kafka"},"datasource":"DS_PROMETHEUS","definition":"kafka_controller_ControllerStats_LeaderElectionRateAndTimeMs","description":null,"error":null,"hide":0,"includeAll":false,"label":null,"multi":false,"name":"namespace","options":[],"query":{"query":"kafka_controller_ControllerStats_LeaderElectionRateAndTimeMs","refId":"DS_PROMETHEUS-namespace-Variable-Query"},"refresh":1,"regex":"\/.*namespace=\\\"([^\\\"]*).*\/","skipUrlSync":false,"sort":0,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false},{"allValue":null,"current":{"selected":false,"text":"kafka-svc","value":"kafka-svc"},"datasource":"DS_PROMETHEUS","definition":"kafka_controller_ControllerStats_LeaderElectionRateAndTimeMs","description":null,"error":null,"hide":0,"includeAll":false,"label":null,"multi":false,"name":"service","options":[],"query":{"query":"kafka_controller_ControllerStats_LeaderElectionRateAndTimeMs","refId":"DS_PROMETHEUS-service-Variable-Query"},"refresh":1,"regex":"\/.*service=\\\"([^\\\"]*).*\/","skipUrlSync":false,"sort":0,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false},{"allValue":null,"current":{"selected":false,"text":"kafka-kafka-0","value":"kafka-kafka-0"},"datasource":"DS_PROMETHEUS","definition":"kafka_controller_ControllerStats_LeaderElectionRateAndTimeMs","description":null,"error":null,"hide":0,"includeAll":false,"label":null,"multi":false,"name":"broker","options":[],"query":{"query":"kafka_controller_ControllerStats_LeaderElectionRateAndTimeMs","refId":"DS_PROMETHEUS-broker-Variable-Query"},"refresh":1,"regex":"\/.*pod=\\\"([^\\\"]*).*\/","skipUrlSync":false,"sort":0,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false}]},"time":{"from":"now-1h","to":"now"},"timepicker":{"refresh_intervals":["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],"time_options":["5m","15m","1h","6h","12h","24h","2d","7d","30d"]},"timezone":"","title":"Kafka: Cluster Summary","uid":"EOMzq8PGz","version":4}
